# https://learn.microsoft.com/en-us/security-updates/securityadvisories/2014/2915720

if((Test-Path -LiteralPath "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config") -ne $true) {  
    New-Item "HKLM:\Software\Microsoft\Cryptography\Wintrust\Config" -force -ea SilentlyContinue 
}
if((Test-Path -LiteralPath "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config") -ne $true) {
    New-Item "HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config" -force -ea SilentlyContinue 
}
New-ItemProperty -LiteralPath 'HKLM:\Software\Microsoft\Cryptography\Wintrust\Config' -Name 'EnableCertPaddingCheck' -Value '1' -PropertyType String -Force -ea SilentlyContinue;
New-ItemProperty -LiteralPath 'HKLM:\Software\Wow6432Node\Microsoft\Cryptography\Wintrust\Config' -Name 'EnableCertPaddingCheck' -Value '1' -PropertyType String -Force -ea SilentlyContinue;
